{% extends 'base.html' %} {% load static %} {% block title %} {{ product.name }}
{% endblock title %} {% block css %}
<link rel="stylesheet" href="{% static 'products/css/product.css' %}" />
{% endblock css %}
{% block body %}

<section id="heading" class="section-heading">
  <img src="{% static 'pages_static/images/section-heading-decor.png' %}" alt="" />
  <h1>Product Section</h1>
  <img class="flip-horizontal" src="{% static 'pages_static/images/section-heading-decor.png' %}" alt="" />
</section>

<section id="product" class="container-lg mt-5">
  <div class="row">
    <div class="col-md-7">
      <div class="container">
        <div class="row">
          <div class="col-4" style="overflow-y: auto" id="select-img-container">
            {% for img in product.images.all %}
            <img src="{{img}}" style="cursor: pointer" class="img-fluid mb-1" alt=""
              onclick="setActiveProductImg(event)" />
            {% endfor %}
          </div>
          <div class="col-7 offset-1">
            <img style="cursor: pointer" src="{{product.images.all.0}}" alt="product"
              class="img-fluid" id="active-product-img" />
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-5 text-center">
      <h1 class="text-sp-red">{{ product.name }}</h1>
      <h3 class="text-secondary">Rs. {{product.price}}</h3>
      <div class="d-flex justify-content-center">
          <div class="number-input ">
            <button onclick="this.parentNode.querySelector('input[type=number]').stepDown()"></button>
            <input form="buynow-form" class="quantity" id="quantity" min="0" name="quantity" value="1" type="number" />
            <button onclick="this.parentNode.querySelector('input[type=number]').stepUp()" class="plus"></button>
          </div>
      </div>
      <p class="fw-light mt-1">Only {{product.stocks}} piece in stock</p>
      <p>{{product.description}}</p>
      <div class='row mt-3 mx-auto'>
          <div class='col-sm-6'>
              <button class="btn st-btn-outline-red my-2" onClick="addToCart(event)" data-bs-toggle="modal"
                data-bs-target="#cartModal" data-id="{{product.id}}" data-name="{{product.name}}" data-price="{{product.price}}"
                dat-stock="{{product.stock}}" data-img="{{product.images.all.0}}">
                Add to your trunk
              </button>
          </div>
          <div class='col-sm-6'>
              <form action="{% url 'buy_now' product.id %}" method="POST" id="buynow-form">
                {% csrf_token %}
                <button type="submit" class="btn styled-btn-filled my-2">Buy Now</button>
              </form>
          </div>
      </div>
    </div>
  </div>
</section>

<section id="info" class="container-lg mt-5">
  <ul class="nav">
    <li class="nav-item">
      <h5 class="tab-parent active" onclick="changeTab(event)" data-target="description" href="#">
        Description
      </h5>
    </li>
    <li class="nav-item">
      <h5 class="tab-parent" onclick="changeTab(event)" data-target="reviews" href="#">
        Reviews
      </h5>
    </li>
    <li class="nav-item">
      <h5 class="tab-parent" onclick="changeTab(event)" data-target="qa" href="#">
        Question and Answer
      </h5>
    </li>
  </ul>
  <div class="tab" id="qa" style="display: none">
    <div class="container-lg my-2">
      {% for faq in faqs.all %}
      <div class="row">
        <div class="row">
          <p class="mb-0 text-sp-red">{{faq.question}}</p>
        </div>
        <div class="row">
          <div class="">{{faq.answer|safe}}</div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  <div class="tab" id="description">{{product.description}}</div>
  <div class="tab" id="reviews" style="display: none">
    <div class="conainer-lg my-2" style="width: 100%">
      <div class="owl-carousel owl-theme">
        {% for review in product.reviews.all %}
        <div class="item">
          <div class="card">
            <div class="card-body">
              <div class="row">
                <div class="col-auto">
                  <div class="usr-img">JL</div>
                </div>
                <div class="col">
                  <h5 class="card-title fw-bold">{{review.user}}</h5>
                  <div class="stars">
                    <div class="stars-pos">
                      {{review.get_rating_stars.0|safe}}
                    </div>
                    <div class="stars-neg">
                      {{review.get_rating_stars.1|safe}}
                    </div>
                  </div>
                  <p class="card-text fw-light">{{review.body}}</p>
                  <div class="card-footer d-flex justify-content-between">
                    <div class="d-flex align-items-center justify-content-center">
                      <div class="me-2">
                        <img class="usr-img" src="/assets/img/shop/Author avatar.png" alt="" />
                      </div>
                      <p>
                        {{review.user}}<span class="fw-light">
                          â€¢ {{review.timestamp|timesince}}</span>
                      </p>
                    </div>

                    <p>+</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<section id="recommendations" class="container-lg mt-5 mb-5">
  <h1 class="text-center text-sp-red my-4">You may also like</h1>
  <div class="row g-2 g-md-5 row-cols-1 row-cols-md-3">
    {% for product in related %}
    <div class="col">
      <img class="img-fluid" src="{{product.images.all.0}}" alt="" />
      <a href="{% url 'product_detail' product.id %}">
        <h2 class="mt-2 text-sp-red">{{product}}</h2>
      </a>
      <p class="fs-4 fw-bold">Rs. {{product.price}}</p>
    </div>
    {% endfor %}
  </div>
</section>
<!-- POP UP -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
  <div class="modal-dialog" style="margin: 0rem 0rem 0rem auto">
    <div class="modal-content">
      <div id="pop">
        <div style="float: right" data-bs-dismiss="modal" aria-label="Close">
          <div class="cross">X</div>
        </div>
        <div class="container">
          <div class="cart text-center">Cart</div>

          <div class="container mt-3" id="cart-container"></div>
        </div>
        <div class="mt-3 cart_hr"></div>
        <p class="sub_title text-center">
          Sub Total - <span id="cart-total"> Rs. 0</span>
        </p>
        <div class="mt-3 cart_hr"></div>
        <div class="view_c mt-5"> <a class="link-light" href="{% url 'cart' %}">View Cart</a> </div>
        <a href="{% url 'create_order' %}">
          <div class="checkout mt-5"> Checkout </div>
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block js %}
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
  integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- owl carousel -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"
  integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"
  integrity="sha512-tS3S5qG0BlhnQROyJXvNjeEM4UpMXHrQfTGmbQ1gKmelCxlSEBUaxhRBj/EFTzpbP4RVSrpEikbmdJobCvhE3g=="
  crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"
  integrity="sha512-sMXtMNL1zRzolHYKEujM2AqCLUR9F2C4/05cdbxjjLSRvMQIciEPCQZo++nk7go3BtSuK9kfa/s+a4f4i5pLkw=="
  crossorigin="anonymous" referrerpolicy="no-referrer" />
<script>
  $(".owl-fw-carousel").owlCarousel({
    loop: true,
    margin: 10,
    nav: true,
    responsive: {
      0: {
        items: 1,
      },
    },
  });
  $(".owl-carousel").owlCarousel({
    // loop: true,
    margin: 10,
    nav: true,
    responsive: {
      0: {
        items: 1,
      },
      800: {
        items: 2,
      },
      1200: {
        items: 3,
      },
    },
  });
</script>
<script src="{% static 'products/js/product.js' %} "></script>
<script src="{% static 'products/js/cart.js' %} "></script>
<script>
  window.addEventListener("DOMContentLoaded", (event) => {
    cart = new Cart();
  });
</script>
{% endblock js %}


{% comment %}
<div class="product-detail">
  <h1>{{ product.name }}</h1>
  <h2>
    <a href="{{ product.category.get_absolute_url }}">
      {{ product.category }}
    </a>
  </h2>
  <p class="price">&#8377; {{ product.price }}</p>
  <form action="{% url 'cart_add' product.id %}" method="post">
    {{ cart_product_form }} {% csrf_token %}
    <input type="submit" value="Add to cart" />
  </form>
  {{ product.description|linebreaks }}
</div>
{% endblock %} {% endcomment %}